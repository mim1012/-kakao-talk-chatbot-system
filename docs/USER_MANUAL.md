# 사용자 매뉴얼

## 목차
1. [시작하기](#시작하기)
2. [기본 사용법](#기본-사용법)
3. [고급 기능](#고급-기능)
4. [문제 해결](#문제-해결)
5. [팁과 트릭](#팁과-트릭)

## 시작하기

### 프로그램 실행

1. **바탕화면 바로가기로 실행** (권장)
   - "카카오톡 챗봇" 아이콘 더블클릭

2. **배치 파일로 실행**
   - `run_with_qt.bat` 더블클릭

3. **명령 프롬프트로 실행**
   ```cmd
   cd "카카오톡 챗봇 시스템"
   python main.py
   ```

### 첫 실행 시 확인사항

1. **카카오톡 위치 확인**
   - 카카오톡을 전체화면으로 설정
   - 채팅방을 열어둔 상태 유지

2. **모니터 설정**
   - 주 모니터: 카카오톡 실행
   - 보조 모니터: 챗봇 GUI 표시 (권장)

## 기본 사용법

### 메인 화면

![메인 화면](images/main_screen.png)

#### 1. 제어 버튼

**모니터링 시작**
- OCR 모니터링을 시작합니다
- 시작 시 오버레이가 자동으로 표시됩니다

**모니터링 중지**
- 진행 중인 모니터링을 중지합니다
- 모든 셀이 초기 상태로 돌아갑니다

**오버레이 표시/숨기기**
- 화면의 그리드 오버레이를 토글합니다
- 모니터링 중에도 숨길 수 있습니다

#### 2. 상태 표시

- **현재 상태**: 유휴/모니터링 중/처리 중
- **활성 셀**: 현재 활성화된 셀 수
- **트리거 횟수**: 감지된 총 횟수
- **마지막 감지**: 최근 감지 시간

### 설정 탭

#### 그리드 설정
- **행 수**: 3-10 (기본값: 3)
- **열 수**: 3-10 (기본값: 5)
- 변경 후 "적용" 클릭 필요

#### OCR 설정
- **스캔 간격**: 0.1-5.0초 (기본값: 0.3초)
- **쿨다운 시간**: 1-60초 (기본값: 5초)
- **GPU 사용**: 체크 시 GPU 가속 활성화

#### 트리거 패턴
- 감지할 텍스트 패턴 추가/제거
- 기본 패턴:
  - "들어왔습니다"
  - "입장했습니다"
  - "참여했습니다"

#### 응답 메시지
- 자동으로 전송할 메시지 설정
- 변수 사용 가능:
  - `{time}`: 현재 시간
  - `{date}`: 현재 날짜

### 로그 탭

#### 로그 레벨
- **DEBUG**: 모든 정보 표시
- **INFO**: 일반 정보만 표시
- **WARNING**: 경고 이상만 표시
- **ERROR**: 오류만 표시

#### 로그 기능
- **로그 지우기**: 현재 표시된 로그 삭제
- **로그 저장**: 파일로 저장
- **자동 스크롤**: 새 로그 자동 스크롤

### 성능 탭

#### 실시간 모니터링
- CPU 사용률 그래프
- 메모리 사용률 그래프
- OCR 처리 시간 차트
- 캐시 효율성 표시

#### 성능 지표
- **평균 응답 시간**: OCR 처리 평균 시간
- **캐시 히트율**: 캐시 효율성
- **초당 처리량**: 처리된 셀 수/초

## 고급 기능

### 오버레이 사용법

#### 색상 의미
- **흰색 테두리**: 유휴 상태
- **녹색 테두리**: 텍스트 감지됨
- **빨간색 테두리**: 쿨다운 중
- **회색 테두리**: 비활성화됨

#### 오버레이 조작
- **드래그**: 오버레이 위치 이동 (비권장)
- **우클릭**: 컨텍스트 메뉴
- **더블클릭**: 해당 셀 토글

### 키보드 단축키

- `Ctrl+S`: 모니터링 시작/중지
- `Ctrl+O`: 오버레이 토글
- `Ctrl+L`: 로그 지우기
- `Ctrl+Q`: 프로그램 종료
- `F1`: 도움말 표시

### 자동화 테스트

1. **테스트 자동화** 버튼 클릭
2. 테스트할 위치 선택
3. 테스트 메시지 입력
4. 결과 확인

### 프로필 관리

#### 설정 프로필 저장
1. 설정 탭에서 원하는 값 설정
2. "프로필 저장" 클릭
3. 프로필 이름 입력

#### 프로필 불러오기
1. "프로필 관리" 클릭
2. 저장된 프로필 선택
3. "불러오기" 클릭

## 문제 해결

### 텍스트가 감지되지 않을 때

1. **OCR 영역 확인**
   - 오버레이의 하단 영역이 텍스트 위치와 일치하는지 확인
   - 설정에서 `ocr_area_y_offset` 조정

2. **화면 배율 확인**
   - Windows 디스플레이 설정에서 배율 100% 확인
   - 카카오톡 DPI 설정 확인

3. **트리거 패턴 확인**
   - 설정 탭에서 올바른 패턴이 등록되어 있는지 확인
   - 대소문자, 띄어쓰기 확인

### 성능이 느릴 때

1. **OCR 간격 늘리기**
   - 0.5초 이상으로 설정

2. **그리드 크기 줄이기**
   - 3x3으로 줄여서 테스트

3. **GPU 사용 확인**
   - 설정에서 GPU 사용 활성화
   - CUDA 설치 확인

### 자동 응답이 작동하지 않을 때

1. **카카오톡 창 활성화**
   - 카카오톡이 최상위 창인지 확인

2. **입력 위치 확인**
   - 메시지 입력창이 정확한 위치에 있는지 확인

3. **권한 확인**
   - 관리자 권한으로 실행

### 오버레이가 보이지 않을 때

1. **다른 프로그램과 충돌**
   - 게임 모드 비활성화
   - 다른 오버레이 프로그램 종료

2. **멀티모니터 설정**
   - 주 디스플레이 설정 확인

## 팁과 트릭

### 최적 설정값

#### 일반 사용
```json
{
    "grid_rows": 3,
    "grid_cols": 5,
    "ocr_interval_sec": 0.3,
    "cooldown_sec": 5
}
```

#### 고성능 PC
```json
{
    "grid_rows": 5,
    "grid_cols": 6,
    "ocr_interval_sec": 0.1,
    "cooldown_sec": 3,
    "ocr_preprocess": {
        "use_gpu": true
    }
}
```

#### 저사양 PC
```json
{
    "grid_rows": 2,
    "grid_cols": 3,
    "ocr_interval_sec": 0.5,
    "cooldown_sec": 10
}
```

### 유용한 트리거 패턴

#### 입장 감지
- "들어왔습니다"
- "입장했습니다"
- "참여했습니다"
- "님이 들어왔습니다"

#### 인사 감지
- "안녕하세요"
- "안녕"
- "하이"
- "반갑습니다"

### 응답 메시지 예시

#### 기본 환영
```
어서오세요! 환영합니다 😊
```

#### 시간대별 인사
```
{time}에 오셨네요! 환영합니다!
```

#### 안내 메시지
```
환영합니다! 
📌 공지사항을 확인해주세요
📌 질문은 자유롭게 해주세요
```

### 성능 최적화 팁

1. **특정 영역만 모니터링**
   - 불필요한 셀 비활성화
   - 채팅 영역에만 집중

2. **캐시 활용**
   - 반복되는 메시지는 캐시로 빠르게 처리
   - 캐시 크기 적절히 설정

3. **배치 처리**
   - 여러 셀을 동시에 처리하도록 설정

## 보안 주의사항

1. **개인정보 보호**
   - 로그 파일에 개인정보 포함 주의
   - 공유 시 로그 확인 필수

2. **자동화 남용 방지**
   - 과도한 자동 응답 자제
   - 카카오톡 이용약관 준수

3. **안전한 사용**
   - 신뢰할 수 없는 설정 파일 사용 금지
   - 정기적인 프로그램 업데이트

## 업데이트 확인

1. 도움말 메뉴 → 업데이트 확인
2. 새 버전이 있으면 다운로드
3. 기존 설정은 자동으로 보존됨

## 추가 도움말

- **공식 문서**: [GitHub Wiki](https://github.com/your-repo/wiki)
- **문제 신고**: [GitHub Issues](https://github.com/your-repo/issues)
- **커뮤니티**: [Discord 서버](https://discord.gg/xxxxx)